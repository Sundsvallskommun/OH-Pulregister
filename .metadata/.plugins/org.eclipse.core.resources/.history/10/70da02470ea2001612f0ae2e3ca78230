<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="html" encoding="utf-8" indent="yes" />

	<xsl:template match="ListNodes">
		<xsl:if test="./Nodes">
		</xsl:if>
		<xsl:choose>
			<xsl:when test="./Nodes">
				<xsl:apply-templates/>
			</xsl:when>
			<xsl:otherwise>
				<div class="container">     
				    <div class="span12">      
				        <button type="button" onclick="location.href='{/document/requestinfo/currentURI}/{/document/module/alias}/choosefacilitytype/1'; return false" class="btn btn-success pull-center biggermargintop"><span class="glyphicon glyphicon-plus"></span>&#160;Skapa ny</button>
				    </div> 
				</div>
					
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>	
	
	<xsl:template match="Nodes">  
  	<table class="table table-condense table-striped">
  		<thead>
			<tr>
				<div class="row">
					<td/>
					<td/>
					<td/>
				  	<td/>
					<td><button type="button" onclick="location.href='{/document/requestinfo/currentURI}/{/document/module/alias}/choosefacilitytype/1'; return false" class="btn btn-success pull-right biggermargintop"><span class="glyphicon glyphicon-plus"></span>&#160;Skapa ny</button></td>
				</div>
			</tr>
			<tr>
				<th width="10"></th>
				<th width="10"></th>
				<th width="40">Namn</th>									
				<th width="40">Beskrivning</th>
				<th width="40">Typ</th>				
				<th width="20"></th>
			</tr>
			
		</thead>
		<tbody>	
  		<xsl:apply-templates select="FacilityNode"/>
  		</tbody>  		
  	</table>
  </xsl:template>
  
  <xsl:template match="FacilityNodeAttribute">  		
  		<xsl:choose>
  			<xsl:when test="./name='Beskrivning'">  				
  				<xsl:value-of select="value"/>  				
  			</xsl:when>
  			<xsl:otherwise>  				
  			</xsl:otherwise>  			
  		</xsl:choose>  		  		  		
  </xsl:template>
  
  <xsl:template match="FacilityNode">  
	<tr>
		<td/>
		<td>
			<xsl:choose>
				<xsl:when test="(facilityNodeAttributes/FacilityNodeAttribute[./FacilityTemplateAttribute/templateAttributeID='76' and string-length(./value)>0]) or (facilityNodeAttributes/FacilityNodeAttribute[./FacilityTemplateAttribute/templateAttributeID='66' and string-length(./value)>0])">  				
	  				<span title="Geografisk plats finns tillagd." class="glyphicon glyphicon-map-marker" style="color:black"></span>		
	  			</xsl:when>	  			
	  			<xsl:otherwise>  				
	  				<span title="Ingen geografisk plats tillagd." class="glyphicon glyphicon-map-marker" style="color:black;opacity:0.15"></span>
	  			</xsl:otherwise>  			
  			</xsl:choose>
  			<span style="padding:8px;"/>
  				
  			<xsl:variable name="fileCount" select="count(AttachedFiles/FacilityFile)"/>
  			
  			<xsl:choose>
				<xsl:when test="AttachedFiles/FacilityFile">
					<xsl:choose>
						<xsl:when test="$fileCount &gt; 1">					
	  						<span title="{$fileCount} filer bifogade" class="glyphicon glyphicon glyphicon-paperclip" style="color:black"></span>
	  					</xsl:when>
	  					<xsl:otherwise>
	  						<span title="{$fileCount} fil bifogad." class="glyphicon glyphicon glyphicon-paperclip" style="color:black"></span>
	  					</xsl:otherwise>
	  				</xsl:choose>		
	  			</xsl:when>
	  			<xsl:otherwise>  				
	  				<span title="Inga filer bifogade." class="glyphicon glyphicon glyphicon-paperclip" style="color:black;opacity:0.15"></span>
	  			</xsl:otherwise>
	  		</xsl:choose>			
		</td>
		<td>   	
  			<a href="{/document/requestinfo/currentURI}/{/document/module/alias}/viewfacility/{node_id}">
  				<xsl:value-of select="name"/>
  			</a>
  			<a style="padding-left: 15px;" href="{/document/requestinfo/currentURI}/{/document/module/alias}/updatefacility/{node_id}">
  				<span class="glyphicon glyphicon-pencil"></span>
  			</a>
  			<a style="padding-left: 15px;" href="{/document/requestinfo/currentURI}/{/document/module/alias}/removefacility/{node_id}">
  				<span class="glyphicon glyphicon-remove"></span>
  			</a>
  		</td>
  		<td>   	  		
  			<xsl:apply-templates select="facilityNodeAttributes"/>  			  		
  		</td>  		
  		<td>
  			<xsl:value-of select="FacilityNodeType/name"/>  				
  			<a  style="padding-left: 15px;"  href="{/document/requestinfo/currentURI}/{/document/module/alias}/updatefacilitytype/{FacilityNodeType/type_id}">
  				<span class="glyphicon glyphicon-pencil"></span>
  			</a>
  		</td>  				
		<td>
		  	
		</td>
  	</tr>	
  </xsl:template>
  
 </xsl:stylesheet>